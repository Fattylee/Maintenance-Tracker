<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Maintenance Tracker</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

 
    <header>
            <div class="container">
            <div class="brand"><a href="index.html">MT</a></div>
        <nav>
           <ul>
                <li><a href="#" id="sign-in">Sign in</a></li>
                <li><a href="#" id="sign-up">Sign up</a></li>
            </ul>
        </nav>
        </div>
    </header>

    <div class="container">
        <h1>Maintenance Tracker</h1>
        <p>
                Maintenance Tracker App is an application that provides users with the ability to reach out to
                operations or repairs department regarding repair or maintenance requests and monitor the
                status of their request.
        </p>
        <div class="data-form">
            <h2>Sign up for Maintenance Tracker</h2>
            <button id="ex">dummy</button>
        <form id = "signupForm" action="#">
            <label for="name">Name</label>
            <input required  type="text" name="name" id="name" placeholder="FirstName LastName">
            
            <label for="email">Email</label>
            <input type="email" required name="email" id="email" placeholder="you@abc.com">
            
            <label for="username">Username</label>
            <input type="text" required name="username" id="username" placeholder="Pick a username">

            <label for="password">Password</label>
            <input type="password" name="password" required id="password" placeholder="Create a password">
            
            <input type="submit" value="Sign up for MT">

        </form>
    </div>
        <div  class="data-form">
            <h2>Sign in to Maintenance Tracker</h2>
                <form id = "signin-form" action="request.html">
                        <label for="username1">Username or email address</label>
                        <input type="text" required name="username1" id="username1" placeholder="Pick a username">
            
                        <label for="password1">Password</label>
                        <input type="password" required name="password1" id="password1" placeholder="CReate a password">
            
                        <input id="signin-user" type="submit" value="Sign in as user">
                        <input id="signin-admin" type="submit" value="Sign in as admin">
                        
            
                </form>
        </div>
    </div>
    <script src="js/toggleForm.js"></script>
    <script>
      
       const signUp = (eventObj) => {
        eventObj.preventDefault();
            
            console.log("from onsubmit");
            let name = document.getElementById('name').value,
                email = document.getElementById('email').value,
                username = document.getElementById('username').value,
                password = document.getElementById('password').value;

            fetch('/api/v1/auth/signup', {
                method: 'POST',
                headers: {
                    'Accept': 'application/json, text/plain, */*',
                    'Content-type': 'application/json'
                },
                body: JSON.stringify({ name, email, username, password })
            })
            .then((res) => res.json())
            .then((data) => {
                console.log('ferom dis', data.token);
            })
            .catch(err => {
                console.log('from catch', err);
            });
        }

        document.getElementById('signupForm').addEventListener('submit', signUp);

        const signIn = (eventObj) => {
        eventObj.preventDefault();
            
            console.log("from onsubmit"); 
               let username = document.getElementById('username1').value,
                password = document.getElementById('password1').value;

            fetch('/api/v1/auth/login', {
                method: 'POST',
                headers: {
                    'Accept': 'application/json, text/plain, */*',
                    'Content-type': 'application/json'
                },
                body: JSON.stringify({ username, password })
            })
            .then((res) => res.json())
            .then((data) => {
                localStorage.setItem('token', data.token);
                console.log('ferom dis', data.token);
            })
            .catch(err => {
                console.log('from catch', err);
            });
        }

        document.getElementById('signin-form').addEventListener('submit', signIn);
       
    </script>
    
</body>
</html>